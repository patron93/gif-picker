$(function(){var t=$(".start-js"),e=$(".page-js"),n={amountStartItems:20,amountLoadedItem:20,amountPopularTags:30},o=function(){var t=n.amountStartItems,e=gifObj.items;return{loadContent:function(n){var o=$(document).height(),s=$(".position-js").offset().top,a=e.length,l=a-t;s>=o-100&&t+n<=a?(i.pushContainer(t,n,e),t+=n):s>=o-100&&l<n&&(i.pushContainer(t,l,e),t+=l)},changeContainer:function(n,o){e=n,t=o}}}(),s=function(){function e(t){var e;for(e=0;e<gifObj.items.length;e++)gifObj.items[e].keys.indexOf(t)>-1&&s.push(gifObj.items[e]);return s}var s=[];return{showResult:function(a){s=[],e(a),i.clearContainer(t),s.length<=n.amountStartItems?i.pushContainer(0,s.length,s):i.pushContainer(0,n.amountStartItems,s),o.changeContainer(s,n.amountLoadedItem)}}}(),a=function(){var t,e,o,s,a=[],i={};for(t=0;t<gifObj.items.length;t++)for(e=0;e<gifObj.items[t].keys.length;e++)i[s=gifObj.items[t].keys[e]]?i[s]+=1:i[s]=1;for(o in i)a.push({name:o,value:i[o]});return a.sort(function(t,e){return e.value-t.value}),{allTags:function(){var t,e;for($(".hash-js").append('<div class="container-fluid"><div class="row"><ul class="all-tags all-tags-js"></ul></div></div>'),t=$(".all-tags-js"),e=0;e<a.length;e++)t.append('<li class="js-tag-item">#'+a[e].name+"</li>")},mostPopular:function(){var t,e;for($(".most-popular-js").append('<ul class="popular popular-js"></ul>'),t=$(".popular-js"),e=0;e<n.amountPopularTags;e++)t.append('<li class="js-tag-item">#'+a[e].name+"</li>")}}}(),i=function(){function e(e,n){var o,s,a;s=$("<div/>",{class:"col-xl-2 col-lg-3 col-md-4 col-sm-4 col-6"}).appendTo(t),a=$("<div/>",{class:"thumb thumb-js"}).appendTo(s),$("<img/>",{src:e,alt:""}).appendTo(a),o=$("<ul/>",{class:"js-tags-list tags-list"}).appendTo(a),$.each(n,function(t,e){$("<li/>",{class:"js-tag-item tag-item",text:"#"+e}).appendTo(o)}),$("<ul/>",{class:"list-collections js-list-collections"}).appendTo(a),$("<i/>",{class:"fa fa-star-o js-favorite","aria-hidden":!0}).appendTo(a),$("<i/>",{class:"fa fa-plus-square-o","aria-hidden":!0}).appendTo(a)}return{pushContainer:function(t,n,o){var s;for(s=t;s<t+n;s++)e(o[s].src,o[s].keys)},clearContainer:function(t){t.find("img").attr("src"," "),t.empty()},changeSearchPanel:function(t){$(".search-state-js").show().find(".search-tag-js").text(t)}}}(),l=function(){function e(t){return JSON.parse(localStorage.getItem(t))}function s(t,e){localStorage.setItem(t,e)}function a(t){var n;(n=e(c)||[]).push(t),s(c,JSON.stringify(n))}function l(t){var n,o;for(n=e(c),o=0;o<n.length;o++)n[o].src===t&&n.splice(o,1);s(c,JSON.stringify(n))}var c="favorites";return{addItems:function(t){var e={keys:[]},n=t.closest(".thumb-js");t.removeClass("fa-star-o").addClass("fa-star"),n.find(".js-tag-item").each(function(){e.keys.push($(this).text().slice(1))}),e.src=n.find("img").attr("src"),a(e)},removeItem:function(t){var e=t.closest(".thumb-js");t.removeClass("fa-star").addClass("fa-star-o"),l(e.find("img").attr("src"))},showFavorites:function(){var s;(s=e(c))&&(i.clearContainer(t),s.length<=n.amountStartItems?i.pushContainer(0,s.length,s):i.pushContainer(0,n.amountStartItems,s),o.changeContainer(s,n.amountLoadedItem),i.changeSearchPanel(c))}}}(),c=function(){function e(t){return JSON.parse(localStorage.getItem(t))}var s=$(".menu");return{toggleMenu:function(t){var e=s.width();t.toggleClass("open"),s.toggleClass("on"),s.hasClass("on")?s.animate({right:"+="+e}):s.animate({right:"-="+e})},buildMenu:function(){var t=e("collections");$(".menu-collections-ul").empty(),$.each(t,function(t,e){$("<i/>",{class:"fa fa-trash-o js-delete-list","aria-hidden":!0}).appendTo($("<li/>",{class:"menu-collections-li",text:e.name}).appendTo(".menu-collections-ul"))})},autoClose:function(){var t=s.width();$(".nav-icon").removeClass("open"),s.removeClass("on"),s.animate({right:"-="+t})},showContentCollection:function(s){var a,l=e("collections");if(l)for(a=0;a<l.length;a++)s===l[a].name&&(i.clearContainer(t),l[a].items.length<=n.amountStartItems?i.pushContainer(0,l[a].items.length,l[a].items):i.pushContainer(0,n.amountStartItems,l[a].items),o.changeContainer(l[a].items,n.amountStartItems),i.changeSearchPanel(l[a].name));$(".fa-plus-square-o").removeClass("fa-plus-square-o").addClass("fa-times")}}}(),r=function(){function t(t){return JSON.parse(localStorage.getItem(t))}function e(t,e){localStorage.setItem(t,e)}function n(){var t,e;t=$("<div/>",{class:"js-container-popup"}),e=$("<div/>",{class:"content-popup"}).appendTo(t),$("<p/>",{text:"pls enter the name of the collection"}).appendTo(e),e.append('<form><input type="text" placeholder="collection name" autofocus><button class="btn-add-list">add</button></form>'),$("body").append(t)}function o(){var t=$(".js-container-popup");t.animate({opacity:0},i,function(){t.remove()})}function s(){$(".js-container-popup").on("click",function(){o()}).find(".content-popup").on("click",function(t){t.stopPropagation()}),$(".btn-add-list").on("click",function(n){n.preventDefault();var s,i=$("input").val();(s=t(a)||[]).push({name:i,items:[]}),o(),e(a,JSON.stringify(s))})}var a="collections",i=300;return{popup:function(){n(),s()},buildUl:function(e){var n,o,s,i=t(a),l=e.closest(".thumb-js").find("img").attr("src");if($(".js-list-collections").find(".li-col").remove(),i)t:for(o=0;o<i.length;o++){for(s=0;s<i[o].items.length;s++)if(l===i[o].items[s].src){$("<li/>",{class:"li-col on",text:i[o].name}).prependTo(".js-list-collections");continue t}$("<li/>",{class:"li-col",text:i[o].name}).prependTo(".js-list-collections")}else this.popup();(n=e.closest(".thumb-js").find(".js-list-collections")).fadeToggle(100),e.closest(".thumb-js").on("mouseleave",function(){n.fadeOut(100)})},addItem:function(n){var o,s,i,l,c={keys:[]},r=n.closest(".thumb-js");r.find(".js-tag-item").each(function(){c.keys.push($(this).text().slice(1))}),c.src=r.find("img").attr("src"),o=n.text(),s=t(a);t:for(i=0;i<s.length;i++)if(o===s[i].name){for(l=0;l<s[i].items.length;l++)if(c.src===s[i].items[l].src)continue t;s[i].items.push(c),n.addClass("on")}e(a,JSON.stringify(s))},removeItem:function(n){var o,s,i=n.closest(".thumb-js"),l=i.find("img").attr("src"),c=t(a);t:for(o=0;o<c.length;o++)if(c[o].name===c[o].name)for(s=0;s<c[o].items.length;s++)if(l===c[o].items[s].src){c[o].items.splice(s,1);break t}e(a,JSON.stringify(c)),i.animate({opacity:0},200,function(){i.closest(".col-xl-2").remove()})},removeList:function(n){var o,s=t(a);for(o=0;o<s.length;o++)if(n===s[o].name){s.splice([o],1);break}0===s.length?localStorage.removeItem(a):e(a,JSON.stringify(s))}}}();({init:function(){this._addElements(),this._startItems(),this._clickPageEvents(),this._scrollEvents(),this._menuEvents()},_startItems:function(){i.pushContainer(0,n.amountStartItems,gifObj.items)},_addElements:function(){$("body").prepend('<div class="done done-top done-js done-top-js"></div><div class="done done-bot done-js done-bot-js"></div><div class="position position-js"></div>'),$(".most-popular-js").append(a.mostPopular()),$(".hash-js").append(a.allTags())},_clickPageEvents:function(){e.on("click",".js-tag-item",function(t){t.stopPropagation();var e=$(this).text().slice(1);s.showResult(e),i.changeSearchPanel("#"+e)}).on("click",".thumb-js",function(){var e=$(this).find("img").attr("src"),n=e.slice(0,e.length-2)+"orig";window.getSelection().removeAllRanges(),t.append('<p class="select">'+n+"</p>");try{var o=document.querySelector(".select"),s=document.createRange();s.selectNode(o),window.getSelection().addRange(s),document.execCommand("copy"),window.getSelection().removeAllRanges(),$(".select").remove(),$(".done-js").removeClass("done-error").addClass("done-successful").fadeIn(100),setTimeout(function(){$(".done-js").fadeOut(500)},200)}catch(t){$(".done-js").removeClass("done-successful").addClass("done-error").fadeIn(100),setTimeout(function(){$(".done-js").fadeOut(500)},200)}}).on("mouseenter",".thumb-js",function(){var t,e,n=$(this).find("img").attr("src");if(t=JSON.parse(localStorage.getItem("favorites")))for(e=0;e<t.length;e++)t[e].src===n&&$(this).find(".js-favorite").hasClass("fa-star-o")&&$(this).find(".fa-star-o").removeClass("fa-star-o").addClass("fa-star")}).on("click",".fa-star-o",function(t){t.stopPropagation(),l.addItems($(this))}).on("click",".fa-star",function(t){t.stopPropagation(),l.removeItem($(this))}).on("click",".fa-plus-square-o",function(t){t.stopPropagation(),r.buildUl($(this))}).on("click",".fa-times",function(t){t.stopPropagation(),r.removeItem($(this))}).on("click",".li-col",function(t){t.stopPropagation(),r.addItem($(this))}),$(".show-more-js").on("click",function(){"on"===$(this).data("opened")?($(this).data("opened","off"),$(".all-tags-js").slideUp(),$(this).find("span").text("show more tags"),$(".most-popular-js").empty().append(a.mostPopular())):($(".all-tags-js").slideDown(),$(".most-popular-js").empty().append("<h4>all tags</h4>"),$(this).find("span").text("show less tags"),$(this).data("opened","on"))}),$(".close-js").on("click",function(){i.clearContainer(t),o.changeContainer(gifObj.items,0),o.loadContent(n.amountLoadedItem),$(".search-state-js").hide()}),$(".btn-top-js").on("click",function(){$("html").animate({scrollTop:0},500)})},_scrollEvents:function(){$(window).on("scroll",function(){o.loadContent(n.amountLoadedItem),$(window).scrollTop()>=200?$(".btn-top-js").fadeIn(200):$(".btn-top-js").fadeOut(200)})},_menuEvents:function(){$(".nav-icon").on("click",function(){c.toggleMenu($(this)),c.buildMenu()}),$(".menu").on("click","li",function(t){t.stopPropagation(),c.autoClose()}).on("click",".menu-collections-li",function(){var t=$(this).text();c.showContentCollection(t)}).on("click",".fa-plus-circle",function(){r.popup()}).on("click",".js-delete-list",function(t){t.stopPropagation();var e=$(this).closest(".menu-collections-li").text();$(this).closest(".menu-collections-li").remove(),r.removeList(e)}),$(".menu-favorites").on("click",function(){l.showFavorites()})}}).init()});